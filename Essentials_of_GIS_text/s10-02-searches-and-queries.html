<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link href="shared/bookhub.css" rel="stylesheet" type="text/css">
  <title>Searches and Queries</title>
</head>
<body>

  
  <div id=navbar-top class="navbar">
    <div class="navbar-part left">
      
        <a href="s10-01-descriptions-and-summaries.html"><img src="shared/images/batch-left.png"></a> <a href="s10-01-descriptions-and-summaries.html">Previous Section</a>
      
    </div>
    <div class="navbar-part middle">
      <a href="index.html"><img src="shared/images/batch-up.png"></a> <a href="index.html">Table of Contents</a>
    </div>
    <div class="navbar-part right">
      
        <a href="s10-03-data-classification.html">Next Section</a> <a href="s10-03-data-classification.html"><img src="shared/images/batch-right.png"></a>
      
    </div>
  </div>

  <div id="book-content">
    <div class="section" id="campbell_1.0-ch06_s02" condition="start-of-chunk" version="5.0" lang="en">
    <h2 class="title editable block">
<span class="title-prefix">6.2</span> Searches and Queries</h2>
    <div class="learning_objectives editable block" id="campbell_1.0-ch06_s02_n01">
        <h3 class="title">Learning Objective</h3>
        <ol class="orderedlist" id="campbell_1.0-ch06_s02_l01">
            <li>The objective of this section is to outline the basics of the SQL language and to understand the various query techniques available in a GIS.</li>
        </ol>
    </div>
    <p class="para editable block" id="campbell_1.0-ch06_s02_p01">Access to robust search and query tools is essential to examine the general trends of a dataset. <span class="margin_term"><a class="glossterm">Queries</a><span class="glossdef">Searches or inquiries.</span></span> are essentially questions posed to a database. The selective display and retrieval of information based on these queries are essential components of any geographic information system (GIS). There are three basic methods for searching and querying attribute data: (1) selection, (2) query by attribute, and (3) query by geography.</p>
    <div class="section" id="campbell_1.0-ch06_s02_s01">
        <h2 class="title editable block">Selection</h2>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s01_p01"><span class="margin_term"><a class="glossterm">Selection</a><span class="glossdef">A defined subset of the larger set of data points or locales.</span></span> represents the easiest way to search and query spatial data in a GIS. Selecting features highlight those attributes of interest, both on-screen and in the attribute table, for subsequent display or analysis. To accomplish this, one selects points, lines, and polygons simply by using the cursor to “point-and-click” the feature of interest or by using the cursor to drag a box around those features. Alternatively, one can select features by using a graphic object, such as a circle, line, or polygon, to highlight all of those features that fall within the object. Advanced options for selecting subsets of data from the larger dataset include creating a new selection, selecting from the currently selected features, adding to the current selection, and removing from the current selection.</p>
    </div>
    <div class="section" id="campbell_1.0-ch06_s02_s02">
        <h2 class="title editable block">Query by Attribute</h2>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p01">Map features and their associated data can be retrieved via the query of attribute information within the data tables. For example, search and query tools allow a user to show all the census tracts that have a population density of 500 or greater, to show all counties that are less than or equal to 100 square kilometers, or to show all convenience stores within 1 mile of an interstate highway.</p>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p02">Specifically, <span class="margin_term"><a class="glossterm">SQL (Structured Query Language)</a><span class="glossdef">A programming language designed to manage data in a relational database.</span></span> is a commonly used computer language developed to query attribute data within a relational database management system. Created by IBM in the 1970s, SQL allows for the retrieval of a subset of attribute information based on specific, user-defined criteria via the implementation of particular language elements. More recently, the use of SQL has been extended for use in a GIS (Shekhar and Chawla 2003).<span class="footnote" id="campbell_1.0-fn06_003">Shekhar, S., and S. Chawla. 2003. <em class="emphasis">Spatial Databases: A Tour</em>. Upper Saddle River, NJ: Prentice Hall.</span> One important note related to the use of SQL is that the exact expression used to query a dataset depends on the GIS file format being examined. For example, ANSI SQL is a particular version used to query ArcSDE geodatabases, while Jet SQL is used to access personal geodatabases. Similarly, shapefiles, coverages, and dBASE tables use a restricted version of SQL that doesn’t support all the features of ANSI SQL or Jet SQL.</p>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p03">As discussed in <a class="xref" href="campbell_1.0-ch05#campbell_1.0-ch05">Chapter 5 "Geospatial Data Management"</a>, <a class="xref" href="campbell_1.0-ch05_s02#campbell_1.0-ch05_s02">Section 5.2 "Geospatial Database Management"</a>, all attribute tables in a relational database management system (RDBMS) used for an SQL query must contain primary and/or foreign keys for proper use. In addition to these keys, SQL implements clauses to structure database queries. A <span class="margin_term"><a class="glossterm">clause</a><span class="glossdef">A grammatical unit in SQL.</span></span> is a language element that includes the SELECT, FROM, WHERE, ORDER BY, and HAVING query statements.</p>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s02_l01">
            <li>SELECT denotes what attribute table fields you wish to view.</li>
            <li>FROM denotes the attribute table in which the information resides.</li>
            <li>WHERE denotes the user-defined criteria for the attribute information that must be met in order for it to be included in the output set.</li>
            <li>ORDER BY denotes the sequence in which the output set will be displayed.</li>
            <li>HAVING denotes the predicate used to filter output from the ORDER BY clause.</li>
        </ul>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p04">While the SELECT and FROM clauses are both mandatory statements in an SQL query, the WHERE is an optional clause used to limit the output set. The ORDER BY and HAVING are optional clauses used to present the information in an interpretable manner.</p>
        <div class="figure large medium-height editable block" id="campbell_1.0-ch06_s02_s02_f01">
            <p class="title"><span class="title-prefix">Figure 6.6</span> Personal Addresses in “ExampleTable” Attribute Table</p>
            <img src="section_10/e0fe0a05ac22294241978243657ad15f.jpg">
        </div>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p05">The following is a series of SQL expressions and results when applied to <a class="xref" href="#campbell_1.0-ch06_s02_s02_f01">Figure 6.6 "Personal Addresses in “ExampleTable” Attribute Table"</a>. The title of the attribute table is “ExampleTable.” Note that the asterisk (*) denotes a special case of SELECT whereby all columns for a given record are selected:</p>
        <span class="informalequation block"><span class="mathphrase">SELECT * FROM ExampleTable WHERE City = “Upland”</span></span>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p06">This statement returns the following:</p>
        <div class="informalfigure large medium-height block">
            <img src="section_10/84ea86f47f2ebf999e9ea90e87cb8b8c.jpg">
        </div>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p07">Consider the following statement:</p>
        <span class="informalequation block"><span class="mathphrase">SELECT LastName FROM ExampleTable WHERE State = “CA” ORDER BY FirstName</span></span>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p08">This statement results in the following table sorted in ascending order by the FirstName column (not included in the output table as directed by the SELECT clause):</p>
        <div class="informalfigure large small-height block">
            <img src="section_10/f295ebb0a4bdbb24e1e7b12f6f09fe58.jpg">
        </div>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p09">In addition to clauses, SQL allows for the inclusion of specific operators to further delimit the result of query. These operators can be relational, arithmetic, or Boolean and will typically appear inside of conditional statements in the WHERE clause. A <span class="margin_term"><a class="glossterm">relational operator</a><span class="glossdef">A construct that tests a relation between two entities.</span></span> employs the statements equal to (=), less than (&lt;), less than or equal to (&lt;=), greater than (&gt;), or greater than or equal to (&gt;=). <span class="margin_term"><a class="glossterm">Arithmetic operators</a><span class="glossdef">A construct that performs an arithmetic function.</span></span> are those mathematical functions that include addition (+), subtraction (−), multiplication (*), and division (/). <span class="margin_term"><a class="glossterm">Boolean operators</a><span class="glossdef">A construct that performs a logical comparison.</span></span> (also called Boolean connectors) include the statements AND, OR, XOR, and NOT. The AND connector is used to select records from the attribute table that satisfies both expressions. The OR connector selects records that satisfy either one or both expressions. The XOR connector selects records that satisfy one and only one of the expressions (the functional opposite of the AND connector). Lastly, the NOT connector is used to negate (or unselect) an expression that would otherwise be true. Put into the language of probability, the AND connector is used to represent an intersection, OR represents a union, and NOT represents a complement. <a class="xref" href="#campbell_1.0-ch06_s02_s02_f02">Figure 6.7 "Venn Diagram of SQL Operators"</a> illustrates the logic of these connectors, where circles A and B represent two sets of intersecting data. Keep in mind that SQL is a very exacting language and minor inconsistencies in the statement, such as additional spaces, can result in a failed query.</p>
        <div class="figure large medium-height editable block" id="campbell_1.0-ch06_s02_s02_f02">
            <p class="title"><span class="title-prefix">Figure 6.7</span> Venn Diagram of SQL Operators</p>
            <img src="section_10/f29eee3abd014546748ecf5a5a598b1b.jpg">
        </div>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p10">Used together, these operators combine to provide the GIS user with powerful and flexible search and query options. With this in mind, can you determine the output set of the following SQL query as it is applied to <a class="xref" href="campbell_1.0-ch06_s01#campbell_1.0-ch06_s01_s01_f01">Figure 6.1 "Histogram Showing the Frequency Distribution of Exam Scores"</a>?</p>
        <span class="informalequation block"><span class="mathphrase">SELECT LastName, FirstName, StreetNumber FROM ExampleTable WHERE StreetNumber &gt;= 10000 AND StreetNumber &lt; 100 ORDER BY LastName</span></span>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s02_p11">The following are the results:</p>
        <div class="informalfigure large medium-height block">
            <img src="section_10/0b2fbb5a504bc4af7b28def08865c012.jpg">
        </div>
    </div>
    <div class="section" id="campbell_1.0-ch06_s02_s03">
        <h2 class="title editable block">Query by Geography</h2>
        <p class="para editable block" id="campbell_1.0-ch06_s02_s03_p01">Query by geography, also known as a “spatial query,” allows one to highlight particular features by examining their position relative to other features. For example, a GIS provides robust tools that allow for the determination of the number of schools within 10 miles of a home. Several spatial query options are available, as outlined here. Throughout this discussion, the “target layer” refers to the feature dataset whose attributes are selected, while the “source layer” refers to the feature dataset on which the spatial query is applied. For example, if we were to use a state boundary polygon feature dataset to select highways from a line feature dataset (e.g., select all the highways that run through the state of Arkansas), the state layer is the source, while the highway layer is the target.</p>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l01">
            <li>
<strong class="emphasis bold">INTERSECT.</strong> This oft-used spatial query technique selects all features in the target layer that share a common locale with the source layer. The “intersect” query allows points, lines, or polygon layers to be used as both the source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f01">Figure 6.8</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f01">
            <p class="title"><span class="title-prefix">Figure 6.8</span> </p>
            <img src="section_10/7a0a60095f2f1d6fff13793fe5ee1d7e.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they intersect the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l04">
            <li>
<strong class="emphasis bold">ARE WITHIN A DISTANCE OF.</strong> This technique requires the user to specify some distance value, which is then used to buffer (<a class="xref" href="campbell_1.0-ch07#campbell_1.0-ch07">Chapter 7 "Geospatial Analysis I: Vector Operations"</a>, <a class="xref" href="campbell_1.0-ch07_s02#campbell_1.0-ch07_s02">Section 7.2 "Multiple Layer Analysis"</a>) the source layer. All features that intersect this buffer are highlighted in the target layer. The “are within a distance of” query allows points, lines, or polygon layers to be used for both the source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f02">Figure 6.9</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f02">
            <p class="title"><span class="title-prefix">Figure 6.9</span> </p>
            <img src="section_10/9b3e5ff24812a99e9258433b2aa95897.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they are within the selected distance of the red features; tan areas represent buffers around the various features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l05">
            <li>
<strong class="emphasis bold">COMPLETELY CONTAIN.</strong> This spatial query technique returns those features that are entirely within the source layer. Features with coincident boundaries are not selected by this query type. The “completely contain” query allows for points, lines, or polygons as the source layer, but only polygons can be used as a target layer (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f03">Figure 6.10</a>).</li>
        </ul>
        <div class="figure large medium-height editable block" id="campbell_1.0-ch06_s02_s03_f03">
            <p class="title"><span class="title-prefix">Figure 6.10</span> </p>
            <img src="section_10/fda78d9b8a0a10435047510dbdffc1b0.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they completely contain the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l06">
            <li>ARE COMPLETELY WITHIN. This query selects those features in the target layer whose entire spatial extent occurs within the geometry of the source layer. The “are completely within” query allows for points, lines, or polygons as the target layer, but only polygons can be used as a source layer (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f04">Figure 6.11</a>).</li>
        </ul>
        <div class="figure large medium-height editable block" id="campbell_1.0-ch06_s02_s03_f04">
            <p class="title"><span class="title-prefix">Figure 6.11</span> </p>
            <img src="section_10/d17f218d182a354e38a64a0a90981abb.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they are completely within the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l07">
            <li>
<strong class="emphasis bold">HAVE THEIR CENTER IN.</strong> This technique selects target features whose center, or centroid, is located within the boundary of the source feature dataset. The “have their center in” query allows points, lines, or polygon layers to be used as both the source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f05">Figure 6.12</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f05">
            <p class="title"><span class="title-prefix">Figure 6.12</span> </p>
            <img src="section_10/febda1bfc18bd42532873ed546bb43ba.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they have their centers in the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l08">
            <li>
<strong class="emphasis bold">SHARE A LINE SEGMENT.</strong> This spatial query selects target features whose boundary geometries share a minimum of two adjacent vertices with the source layer. The “share a line segment” query allows for line or polygon layers to be used for either of the source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f06">Figure 6.13</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f06">
            <p class="title"><span class="title-prefix">Figure 6.13</span> </p>
            <img src="section_10/6c65cad889f14c080ec6bd140042d536.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they share a line segment with the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l09">
            <li>
<strong class="emphasis bold">TOUCH THE BOUNDARY OF.</strong> This methodology is similar to the INTERSECT spatial query; however, it selects line and polygon features that share a common boundary with target layer. The “touch the boundary of” query allows for line or polygon layers to be used as both the source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f07">Figure 6.14</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f07">
            <p class="title"><span class="title-prefix">Figure 6.14</span> </p>
            <img src="section_10/1eea122af6a0514477053c9fd1e4ae09.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they touch the boundary of the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l10">
            <li>
<strong class="emphasis bold">ARE IDENTICAL TO.</strong> This spatial query returns features that have the exact same geographic location. The “are identical to” query can be used on points, lines, or polygons, but the target layer type must be the same as the source layer type (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f08">Figure 6.15</a>).</li>
        </ul>
        <div class="figure large medium-height editable block" id="campbell_1.0-ch06_s02_s03_f08">
            <p class="title"><span class="title-prefix">Figure 6.15</span> </p>
            <img src="section_10/5d759c185697124c78c237c38e36f30d.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they are identical to the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l11">
            <li>
<strong class="emphasis bold">ARE CROSSED BY THE OUTLINE OF.</strong> This selection criteria returns features that share a single vertex but not an entire line segment. The “are crossed by the outline of” query allows for line or polygon layers to be used as both source and target layers (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f09">Figure 6.16</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f09">
            <p class="title"><span class="title-prefix">Figure 6.16</span> </p>
            <img src="section_10/bc4348930205b5d1b86977f9ba505860.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they are crossed by the outline of the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l12">
            <li>
<strong class="emphasis bold">CONTAIN.</strong> This method is similar to the COMPLETELY CONTAIN spatial query; however, features in the target layer will be selected even if the boundaries overlap. The “contain” query allows for point, line, or polygon features in the target layer when points are used as a source; when line and polygon target layers with a line source; and when only polygon target layers with a polygon source (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f10">Figure 6.17</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f10">
            <p class="title"><span class="title-prefix">Figure 6.17</span> </p>
            <img src="section_10/b9fb88c22ae4490c609a22997f05f550.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they contain the red features.</p>
        </div>
        <ul class="itemizedlist editable block" id="campbell_1.0-ch06_s02_s03_l13">
            <li>
<strong class="emphasis bold">ARE CONTAINED BY.</strong> This method is similar to the ARE COMPLETELY WITHIN spatial query; however, features in the target layer will be selected even if the boundaries overlap. The “are contained by” query allows for point, line, or polygon features in the target layer when polygons are used as a source; when point and line target layers with a line source; and when only point target layers with a point source (<a class="xref" href="#campbell_1.0-ch06_s02_s03_f11">Figure 6.18</a>).</li>
        </ul>
        <div class="figure large large-height editable block" id="campbell_1.0-ch06_s02_s03_f11">
            <p class="title"><span class="title-prefix">Figure 6.18</span> </p>
            <img src="section_10/ebbcab4d654e600bc258816adbb8863b.jpg">
            <p class="para">The highlighted blue and yellow features are selected because they are contained by the red features.</p>
        </div>
        <div class="key_takeaways editable block" id="campbell_1.0-ch06_s02_s03_n01">
            <h3 class="title">Key Takeaways</h3>
            <ul class="itemizedlist" id="campbell_1.0-ch06_s02_s03_l02">
                <li>The three basic methods for searching and querying attribute data are selection, query by attribute, and query by geography.</li>
                <li>SQL is a commonly used computer language developed to query by attribute data within a relational database management system.</li>
                <li>Queries by geography allow a user to highlight desired features by examining their position relative to other features. The eleven different query-by-geography options listed here are available in most GIS software packages.</li>
            </ul>
        </div>
        <div class="exercises editable block" id="campbell_1.0-ch06_s02_s03_n02">
            <h3 class="title">Exercises</h3>
            <ol class="orderedlist" id="campbell_1.0-ch06_s02_s03_l03">
                <li>Using <a class="xref" href="campbell_1.0-ch06_s01#campbell_1.0-ch06_s01_s01_f01">Figure 6.1 "Histogram Showing the Frequency Distribution of Exam Scores"</a>, develop the SQL statement that results in the output of all the street names of people living in Los Angeles, sorted by street number.</li>
                <li>When querying by geography, what is the difference between a source layer and a target layer?</li>
                <li>What is the difference between the CONTAIN, COMPLETELY CONTAIN, and ARE CONTAINED BY queries?</li>
            </ol>
        </div>
    </div>
</div>

  </div>
  
  <div id=navbar-bottom class="navbar">
    <div class="navbar-part left">
      
        <a href="s10-01-descriptions-and-summaries.html"><img src="shared/images/batch-left.png"></a> <a href="s10-01-descriptions-and-summaries.html">Previous Section</a>
      
    </div>
    <div class="navbar-part middle">
      <a href="index.html"><img src="shared/images/batch-up.png"></a> <a href="index.html">Table of Contents</a>
    </div>
    <div class="navbar-part right">
      
        <a href="s10-03-data-classification.html">Next Section</a> <a href="s10-03-data-classification.html"><img src="shared/images/batch-right.png"></a>
      
    </div>
  </div>

  </div>
  <script type="text/javascript" src="shared/book.js"></script>
  
  
</body>
</html>
